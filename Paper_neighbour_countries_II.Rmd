---
title: "Einschätzung zu den Befindlichkeiten der Wirtschaft in den Nachbarländern"
author: "Simon Wey"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  pdf_document:
    pandoc_args: --listings
    includes: 
      #in_header: preamble.tex
      includes:
      in_header: header.tex 
      fig_caption: yes
  html_document:
    df_print: paged
  word_document: default
bibliography: reference.bib
csl: elsevier-harvard.csl
header-includes: \usepackage{graphicx}
abstract: 
- Die steigenden Inflationsraten beschäftigen nicht nur Konsumentinnen und Konsumenten, sondern auch die Politik, die   sich überlegen muss, ob und wie sie gegen den Kaufkraftverlust vorgehen will. Mit ihrer überraschend starken         Erhöhung des Leitzinses hat die Schweizerische Nationalbank viele überrascht. Es bleiben die preistreibenden Entwicklungen als Folge des Ukrainekriegs und der Corona-Pandemie, wobei diese die zugrundeliegende Teuerung aufgrund der expansiven Geldpolitik der Notenbanken überlagern. Eine vergleichbare Situation war die «Great depression» in den 70er-Jahren. Eine Mehrheit der von NZZ und KOF befragten Ökonomen geht von einem temporären Anstieg der Inflation aus. Der Spielraum für Lohnerhöhungen bleibt überschaubar, denn auch die Unternehmen kämpfen beim Bezug von Vorprodukten mit den höheren Preisen. Dies nagt an der Marge und somit am Spielraum für Lohnerhöhungen. Daneben kühlt sich auch die wirtschaftliche Entwicklung ab, etwa aufgrund der zunehmend restriktiveren Geldpolitik, des Ukrainie-Kriegs oder der nach wie vor schwierigen Covid-Situation in China.
tags:
- nothing
- nothingness
---
```{r setup, include=FALSE}
library(knitr)
opts_chunk$set(echo = FALSE, message=FALSE)
library(kofdata)
library(tstools)
library(lubridate)
library("eurostat")
library(dplyr) 
library(ggplot2)
library(xtable)
options(xtable.comment=FALSE)

```


\renewcommand{\figurename}{Abbildung} 
\fontsize{13}{16}

\selectfont

## Befindlichkeit Gesamtwirtschaft (Economic Sentiment Indicator)

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.
A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.



```{r plot4, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}

rm(list=ls())


tsl <- get_time_series("ch.kof.barometer")
s_tsl <- lapply(tsl,window, start=c(2020,1))
pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/baro.pdf')
tsplot(s_tsl)
#s_tsl$ch.kof.barometer[length(s_tsl$ch.kof.barometer)]
#s_tsl$ch.kof.barometer[length(s_tsl$ch.kof.barometer)-1]


dates_2 <- date_decimal(as.numeric(time(s_tsl$ch.kof.barometer)))
a <- month(dates_2[length(dates_2)-1],label=TRUE,abbr = FALSE)

#knit_global()

dev.off()


```

\begin{figure}[] \centering
\includegraphics[trim={0 2.5cm 0 0cm },clip,width=.6\textwidth]
{/Users/simonwey/Repos/Foreign_economics/Graphics/baro.pdf}
\caption{KOF-Konjunkturbarometer mit aktuellem Wert im `r month(dates_2[length(date_decimal(as.numeric(time(s_tsl$ch.kof.barometer))))],label=TRUE,abbr = FALSE)` von `r round(s_tsl$ch.kof.barometer[length(s_tsl$ch.kof.barometer)],1)
`} 
\label{Inf_M_W}
\end{figure}

**Monat** | **`r month(dates_2[length(date_decimal(as.numeric(time(s_tsl$ch.kof.barometer))))-1],label=TRUE,abbr = FALSE)`** | **`r month(dates_2[length(date_decimal(as.numeric(time(s_tsl$ch.kof.barometer))))],label=TRUE,abbr = FALSE)`**
------------- | -------------|-------------
**KOF-Konjunktur-Barometer** | `r round(s_tsl$ch.kof.barometer[length(s_tsl$ch.kof.barometer)-1],1)` | `r round(s_tsl$ch.kof.barometer[length(s_tsl$ch.kof.barometer)],1)`
Table: KOF-Konjunkturbarometer, letzte Werte. Quelle: KOF



# hallo

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.
A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.

A confidence indicator is a statistical indicator based on the results from business surveys interrogating enterprises on their current economic situation and their expectations about future developments. Five separate confidence indicators are produced, for industry, construction, services, retail trade and consumers.


```{r plot5, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}

rm(list=ls())

# just for viz
tsl <- get_time_series(c(
  "ch.kof.esi.index",
  "eu.ec.esi.eu.esi"))
s_tsl <- lapply(tsl,window, start=c(2010,1))
pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/ESI.pdf')
tsplot(s_tsl)
#legend('topleft', legend=c("ESI Schweiz", "ESI EU"), bg='white')
dev.off()
dates_2 <- date_decimal(as.numeric(time(s_tsl$ch.kof.esi.index)))


```
\begin{figure}[] \centering
\includegraphics[trim={0 0cm 0 0cm },clip,width=.6\textwidth]
{/Users/simonwey/Repos/Foreign_economics/Graphics/ESI.pdf}
\caption{Economic Sentiment Indicator Schweiz und EU} 
\label{Inf_M_W}
\end{figure}


**Monat** | **`r month(dates_2[length(date_decimal(as.numeric(time(s_tsl$ch.kof.esi.index))))-1],label=TRUE,abbr = FALSE)`** | **`r month(dates_2[length(date_decimal(as.numeric(time(s_tsl$ch.kof.esi.index))))],label=TRUE,abbr = FALSE)`**
------------- | -------------|-------------
**ESI Schweiz** | `r round(s_tsl$ch.kof.esi.index[length(s_tsl$ch.kof.esi.index)-1],1)` | `r round(s_tsl$ch.kof.esi.index[length(s_tsl$ch.kof.esi.index)],1)`
------------- | -------------|-------------
**ESI EU** | `r round(s_tsl$eu.ec.esi.eu.esi[length(s_tsl$eu.ec.esi.eu.esi)-1],1)` | `r round(s_tsl$eu.ec.esi.eu.esi[length(s_tsl$eu.ec.esi.eu.esi)],1)`
Table: ESI, letzte Werte. Quelle: KOF


```{r plot0, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}

rm(list=ls())


#query <- search_eurostat(pattern="hindering", fixed=FALSE)

cat <- c("AT","DE","EA19","FR","IT")
ty <- c("BS-ESI-I","BS-ICI-BAL","BS-SCI-BAL")  #  ,"BS-ESI-I",
t <- c("BAD","VBAD")#"GOOD","VGOOD")

#dat_hind_fac_i <- get_eurostat(id="ei_bsin_q_r2") #Industry (quarterly: ei_bsin_q_r2)
#dat_hind_fac_s <- get_eurostat(id="ei_bsse_q_r2") #Services (quarterly: ei_bsse_q_r2)
dat_s_indic <- get_eurostat(id="ei_bssi_m_r2") 
#dat_empl_exp <- get_eurostat(id="teibs040") 

#d <- filter(dat,indic %in% ty, geo == "IT", s_adj =="SA",time>="2010-01-01") 
d <- filter(dat_s_indic,indic %in% ty, geo %in% cat, s_adj =="SA",time>="2020-01-01") 


d$geo[d$geo=="AT"] <- "Österreich"
d$geo[d$geo=="EA19"] <- "EU-19"
d$geo[d$geo=="DE"] <- "Deutschland"
d$geo[d$geo=="FR"] <- "Frankreich"
d$geo[d$geo=="IT"] <- "Italien"

d$indic[d$indic=="BS-ESI-I"] <- "Wirtschaftliche Lage"
d$indic[d$indic=="BS-ICI-BAL"] <- "Industrie: Vertrauensindikator"
d$indic[d$indic=="BS-SCI-BAL"] <- "Dienstleistungen: Vertrauensindikator"


p <- ggplot(data = d) + 
    geom_line(mapping = aes(x = time, y = values, color=indic),size=.6) + 
    scale_color_manual(name="HADK",values = c("#eb4255","#8E44AD","#ffa500","#659065","#A0522D")) +
    #  geom_text(data=dat %>% group_by(geo)%>% filter(time==max(time)),size=2.6) + 
    # theme(legend.position="left")+
    #  scale_color_manual(values = c("#8E44AD", "#F1C40F","#34495E","#138D75","#E74C3C","#F8C471"))+
    labs(#title = "Erwerbslosenrate",
      #subtitle = "Quelle: Eurostat",
      y = "",
      x = "") +
    theme_minimal()+
    theme(legend.position="bottom",legend.title=element_blank()) + 
    guides(color = guide_legend(nrow = 2, byrow = TRUE)) +
    coord_fixed(ratio=5) +  
    #ggtitle("Inflationsraten - excluding energy")+
    theme(text = element_text(size = 15))+
    scale_y_continuous(labels = function(x) paste0(x*1, "%")) +
    scale_x_date(date_breaks = "6 month", date_labels ="%m-%Y")+
    theme(axis.text.x = element_text( 
      angle = 90, 
      #color="blue", 
      vjust=0.6),strip.text.x = element_text(face = "bold")#,
      #size=15)#, 
      #  face=1)
    )+ 
    #facet_wrap(~ LOCATION, nrow = 2) 
    facet_wrap(factor(geo,levels=c("EU-19","Deutschland","Frankreich","Italien","Österreich")) ~ .,nrow=2) #+
    #geom_text_repel(
    #aes(x=Time,y = values,label=values), data = data_ends,
    #fontface ="plain", color = "black", size = 5
 # ) 

pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/wrap_ESI.pdf')
print(p)
dev.off()



```

\begin{figure}[h] \centering
\includegraphics[trim={0 0cm 0 0cm },clip,width=\textwidth]{/Users/simonwey/Repos/Foreign_economics/Graphics/wrap_ESI.pdf}
\caption{Einschätzungen zur wirtschaftlichen Lage in der Gesamtwirtschaft und den Sektoren} 
\label{Inf_M_W}
\end{figure}

```{r}
# Fake confusion matrix to work with
x = structure(c(34L, 6L, 9L, 35L), .Dim = c(2L, 2L), .Dimnames = structure(list(
    Actual = c("EU-19","Deutschland" ), Predicted = c(format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[2],"%B"), format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[1],"%B"))), .Names = c("Land", 
"Einschätzung zur Wirtschaft")), class = "table")

x=cbind(x, prop.table(x), prop.table(x, 1), prop.table(x,2))
x[, -c(1,2)] = sapply(x[,-c(1,2)], function(i) paste0(sprintf("%1.1f", i*100),"%"))
x = cbind(Actual=rownames(x), x)
```  



**Wirtsch. Lage** | **`r format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[2],"%B")`** | **`r format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[1],"%B")`**
------------- | -------------|-------------
**EU-19** | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$values[2]` | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$values[1]`
**Deutschland** | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="Deutschland")$values[2]` | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="Deutschland")$values[1]`
**Frankreich** | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="Frankreich")$values[2]` | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="Frankreich")$values[1]`
**Italien** | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="Italien")$values[2]` | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="Italien")$values[1]`
**Österreich** | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="Österreich")$values[2]` | `r filter(d,indic=="Wirtschaftliche Lage" & geo=="Österreich")$values[1]`
Table: Einschätzung zur wirtschaftlichen Lage in den entsprechenden Ländern. Quelle: Eurostat

```{r}
x <- structure(c(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$values[2], filter(d,indic=="Wirtschaftliche Lage" & geo=="Deutschland")$values[2], filter(d,indic=="Wirtschaftliche Lage" & geo=="Frankreich")$values[2], filter(d,indic=="Wirtschaftliche Lage" & geo=="Italien")$values[2],filter(d,indic=="Wirtschaftliche Lage" & geo=="Österreich")$values[2],filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$values[1], filter(d,indic=="Wirtschaftliche Lage" & geo=="Deutschland")$values[1], filter(d,indic=="Wirtschaftliche Lage" & geo=="Frankreich")$values[1], filter(d,indic=="Wirtschaftliche Lage" & geo=="Italien")$values[1],filter(d,indic=="Wirtschaftliche Lage" & geo=="Österreich")$values[1],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="EU-19")$values[2],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="Deutschland")$values[2],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="Frankreich")$values[2],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="Italien")$values[2],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="Österreich")$values[2],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="EU-19")$values[1],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="Deutschland")$values[1],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="Frankreich")$values[1],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="Italien")$values[1],filter(d,indic=="Industrie: Vertrauensindikator" & geo=="Österreich")$values[1],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="EU-19")$values[2],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="Deutschland")$values[2],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="Frankreich")$values[2],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="Italien")$values[2],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="Österreich")$values[2],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="EU-19")$values[1],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="Deutschland")$values[1],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="Frankreich")$values[1],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="Italien")$values[1],filter(d,indic=="Dienstleistungen: Vertrauensindikator" & geo=="Österreich")$values[1]),.Dim = c(5, 6), .Dimnames = structure(list(Actual = c("EU-19", "Deutschland","Frankreich","Italien","Österreich"), Predicted = c( format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[2],"%B"), format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[1],"%B"),format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[2],"%B"), format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[1],"%B"),format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[2],"%B"), format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[1],"%B"))), .Names = c("Actual", "Predicted")), class = "table")




PrintConfusionMatrix <- function(data, ...) {

  stopifnot(all(dim(x) == c(5, 6)))

#  colnames(x) <- sprintf("\\emph{%s}", colnames(x)) # highlight colnames
#  rownames(x) <- sprintf("\\emph{%s}", rownames(x)) # highlight rownames

  cat('\\begin{tabular}{|c *{8}{|C{2cm}}|} \\cline{2-7}
    \\multicolumn{1}{c|}{} & \\multicolumn{6}{c|}{\\textbf{Einschätzungen}} \\\\ \\cline{2-7}
    \\multicolumn{1}{c|}{} & \\multicolumn{2}{c|}{\\textbf{Wirtsch. Lage}} & \\multicolumn{2}{c|}{\\textbf{Ind.\nVertrauensind.}} & \\multicolumn{2}{c|}{\\textbf{DL\n Vertrauensind.}} \\\\ \\hline
    \\textbf{Land} ')


  print(xtable(x),
        only.contents = TRUE, 
        comment = FALSE,
        sanitize.colnames.function = identity, 
        sanitize.rownames.function = identity, 
        hline.after = 0:5,
        ...)
  cat("\\end{tabular}")
}
```

```{r, results='asis'}
PrintConfusionMatrix(x)
```

```{r}
  x <- structure(c(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$values[2], filter(d,indic=="Wirtschaftliche Lage" & geo=="Deutschland")$values[2], filter(d,indic=="Wirtschaftliche Lage" & geo=="Frankreich")$values[2], filter(d,indic=="Wirtschaftliche Lage" & geo=="Italien")$values[2],filter(d,indic=="Wirtschaftliche Lage" & geo=="Österreich")$values[2],filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$values[1],filter(d,indic=="Wirtschaftliche Lage" & geo=="Deutschland")$values[1],filter(d,indic=="Wirtschaftliche Lage" & geo=="Frankreich")$values[1],filter(d,indic=="Wirtschaftliche Lage" & geo=="Italien")$values[1],filter(d,indic=="Wirtschaftliche Lage" & geo=="Österreich")$values[1]),.Dim = c(5, 2), .Dimnames = structure(list(Actual = c("EU-19", "Deutschland","Frankreich","Italien","Österreich"), Predicted = c( format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[2],"%B"),  format(filter(d,indic=="Wirtschaftliche Lage" & geo=="EU-19")$time[1],"%B"))), .Names = c("Actual", "Predicted")), class = "table")



PrintConfusionMatrix <- function(data, ...) {

  stopifnot(all(dim(x) == c(5, 2)))

#  colnames(x) <- sprintf("\\emph{%s}", colnames(x)) # highlight colnames
#  rownames(x) <- sprintf("\\emph{%s}", rownames(x)) # highlight rownames

  cat('\\begin{tabular}{|c *{8}{|C{2cm}}|} \\cline{2-3}
    \\multicolumn{1}{c|}{} & \\multicolumn{2}{c|}{\\textbf{Wirtsch. Lage}} \\\\ \\hline     \\textbf{Land} ')


  print(xtable(x),
        only.contents = TRUE, 
        comment = FALSE,
        sanitize.colnames.function = identity, 
        sanitize.rownames.function = identity, 
        hline.after = 0:5,
        ...)
  cat("\\end{tabular}")
}
```

```{r, results='asis'}
PrintConfusionMatrix(x)
```



## Industrie

```{r plot1, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}

rm(list=ls())

cat <- c("AT","DE","EA19","FR","IT")
t <- c("BS-FLP3-PC","BS-FLP5-PC","BS-FLP1-PC")  #  ,"BS-ESI-I",	

dat_hind_fac_i <- get_eurostat(id="ei_bsin_q_r2") #Industry (quarterly: ei_bsin_q_r2)
#dat_hind_fac_s <- get_eurostat(id="ei_bsse_q_r2") #Services (quarterly: ei_bsse_q_r2)
#dat_s_indic <- get_eurostat(id="ei_bssi_m_r2") 
#dat_empl_exp <- get_eurostat(id="teibs040") 

#d <- filter(dat,indic %in% ty, geo == "IT", s_adj =="SA",time>="2010-01-01") 
d_hind_i <- filter(dat_hind_fac_i,indic %in% t, geo %in% cat, s_adj == "SA",time>="2016-01-01") 


d_hind_i$geo[d_hind_i$geo=="AT"] <- "Österreich"
d_hind_i$geo[d_hind_i$geo=="EA19"] <- "EU-19"
d_hind_i$geo[d_hind_i$geo=="DE"] <- "Deutschland"
d_hind_i$geo[d_hind_i$geo=="FR"] <- "Frankreich"
d_hind_i$geo[d_hind_i$geo=="IT"] <- "Italien"

d_hind_i$indic[d_hind_i$indic=="BS-FLP3-PC"] <- "Arbeitskräftemangel"
d_hind_i$indic[d_hind_i$indic=="BS-FLP5-PC"] <- "Andere"
d_hind_i$indic[d_hind_i$indic=="BS-FLP1-PC"] <- "Keine"
#d_hind_i$indic[d_hind_i$indic=="BS-FLP2-PC"] <- "Insufficient Demand"



p <- ggplot(data = d_hind_i) + 
    geom_line(mapping = aes(x = time, y = values, color=indic),size=.6) + 
    scale_color_manual(values = c("#eb4255","#8E44AD","#ffa500","#659065","#A0522D")) +
    #  geom_text(data=dat %>% group_by(geo)%>% filter(time==max(time)),size=2.6) + 
    # theme(legend.position="left")+
    #  scale_color_manual(values = c("#8E44AD", "#F1C40F","#34495E","#138D75","#E74C3C","#F8C471"))+
    labs(#title = "Erwerbslosenrate",
      #subtitle = "Quelle: Eurostat",
      y = "",
      x = "") +
    theme_minimal()+
    theme(legend.position="bottom",legend.title=element_blank()) + 
    guides(color = guide_legend(nrow = 2, byrow = TRUE)) +
    coord_fixed(ratio=20) +  
    #ggtitle("Inflationsraten - excluding energy")+
    theme(text = element_text(size = 15))+
    scale_y_continuous(labels = function(x) paste0(x*1, "%")) +
    scale_x_date(date_breaks = "12 month", date_labels ="%m-%Y")+
    theme(axis.text.x = element_text( 
      angle = 90, 
      #color="blue", 
      vjust=0.6),strip.text.x = element_text(face = "bold")#,
      #size=15)#, 
      #  face=1)
    )+ 
    #facet_wrap(~ LOCATION, nrow = 2) 
    facet_wrap(factor(geo,levels=c("EU-19","Deutschland","Frankreich","Italien","Österreich")) ~ .,nrow=2) #+
    #geom_text_repel(
    #aes(x=Time,y = values,label=values), data = data_ends,
    #fontface ="plain", color = "black", size = 5
 # ) 

pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/wrap_Hin_i.pdf')
print(p)
dev.off()


```
\begin{figure}[h] \centering
\includegraphics[trim={0 2.5cm 0 0cm },clip,width=\textwidth]{/Users/simonwey/Repos/Foreign_economics/Graphics/wrap_Hin_i.pdf}
\caption{Industrie: Hemmnisse in der Produktion} 
\label{Inf_M_W}
\end{figure}

```{r}
x <- structure(c(filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="EU-19")$values[2], filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="Deutschland")$values[2], filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="Frankreich")$values[2], filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="Italien")$values[2],filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="Österreich")$values[2],filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="EU-19")$values[1], filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="Deutschland")$values[1], filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="Frankreich")$values[1], filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="Italien")$values[1],filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="Österreich")$values[1],filter(d_hind_i,indic=="Keine" & geo=="EU-19")$values[2], filter(d_hind_i,indic=="Keine" & geo=="Deutschland")$values[2], filter(d_hind_i,indic=="Keine" & geo=="Frankreich")$values[2], filter(d_hind_i,indic=="Keine" & geo=="Italien")$values[2],filter(d_hind_i,indic=="Keine" & geo=="Österreich")$values[2],filter(d_hind_i,indic=="Keine" & geo=="EU-19")$values[1], filter(d_hind_i,indic=="Keine" & geo=="Deutschland")$values[1], filter(d_hind_i,indic=="Keine" & geo=="Frankreich")$values[1], filter(d_hind_i,indic=="Keine" & geo=="Italien")$values[1],filter(d_hind_i,indic=="Keine" & geo=="Österreich")$values[1],filter(d_hind_i,indic=="Andere" & geo=="EU-19")$values[2], filter(d_hind_i,indic=="Andere" & geo=="Deutschland")$values[2], filter(d_hind_i,indic=="Andere" & geo=="Frankreich")$values[2], filter(d_hind_i,indic=="Andere" & geo=="Italien")$values[2],filter(d_hind_i,indic=="Andere" & geo=="Österreich")$values[2],filter(d_hind_i,indic=="Andere" & geo=="EU-19")$values[1], filter(d_hind_i,indic=="Andere" & geo=="Deutschland")$values[1], filter(d_hind_i,indic=="Andere" & geo=="Frankreich")$values[1], filter(d_hind_i,indic=="Andere" & geo=="Italien")$values[1],filter(d_hind_i,indic=="Andere" & geo=="Österreich")$values[1]),.Dim = c(5, 6), .Dimnames = structure(list(Actual = c("EU-19", "Deutschland","Frankreich","Italien","Österreich"), Predicted = c(format(filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[2],"%B"),format(filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[1],"%B"),format(filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[2],"%B"),format(filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[1],"%B"),format(filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[2],"%B"),format(filter(d_hind_i,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[1],"%B"))), .Names = c("Actual", "Predicted")), class = "table")




PrintConfusionMatrix <- function(data, ...) {

  stopifnot(all(dim(x) == c(5, 6)))

#  colnames(x) <- sprintf("\\emph{%s}", colnames(x)) # highlight colnames
#  rownames(x) <- sprintf("\\emph{%s}", rownames(x)) # highlight rownames

  cat('\\begin{tabular}{|c *{8}{|C{2cm}}|} \\cline{2-7}
    \\multicolumn{1}{c|}{} & \\multicolumn{6}{c|}{\\textbf{Einschätzungen Hemmnisse}} \\\\ \\cline{2-7}
    \\multicolumn{1}{c|}{} & \\multicolumn{2}{c|}{\\textbf{Arbeitskräftemangel}} & \\multicolumn{2}{c|}{\\textbf{Keine}} & \\multicolumn{2}{c|}{\\textbf{Andere}} \\\\ \\hline
    \\textbf{Land} ')


  print(xtable(x),
        only.contents = TRUE, 
        comment = FALSE,
        sanitize.colnames.function = identity, 
        sanitize.rownames.function = identity, 
        hline.after = 0:5,
        ...)
  cat("\\end{tabular}")
}
```

```{r, results='asis'}
PrintConfusionMatrix(x)
```


## Dienstleistungen

```{r plot2, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}

rm(list=ls())



cat <- c("AT","DE","EA19","FR","IT")
t <- c("BS-FLB3-PC","BS-FLB6-PC","BS-FLB1-PC")  #  ,"BS-ESI-I",	

dat_hind_fac_s <- get_eurostat(id="ei_bsse_q_r2") #Industry (quarterly: ei_bsin_q_r2)
#dat_hind_fac_s <- get_eurostat(id="ei_bsse_q_r2") #Services (quarterly: ei_bsse_q_r2)
#dat_s_indic <- get_eurostat(id="ei_bssi_m_r2") 
#dat_empl_exp <- get_eurostat(id="teibs040") 

#d <- filter(dat,indic %in% ty, geo == "IT", s_adj =="SA",time>="2010-01-01") 
d_hind_s <- filter(dat_hind_fac_s,indic %in% t, geo %in% cat, s_adj == "SA",time>="2016-01-01") 


d_hind_s$geo[d_hind_s$geo=="AT"] <- "Österreich"
d_hind_s$geo[d_hind_s$geo=="EA19"] <- "EU-19"
d_hind_s$geo[d_hind_s$geo=="DE"] <- "Deutschland"
d_hind_s$geo[d_hind_s$geo=="FR"] <- "Frankreich"
d_hind_s$geo[d_hind_s$geo=="IT"] <- "Italien"

d_hind_s$indic[d_hind_s$indic=="BS-FLB3-PC"] <- "Arbeitskräftemangel"
d_hind_s$indic[d_hind_s$indic=="BS-FLB6-PC"] <- "Andere"
d_hind_s$indic[d_hind_s$indic=="BS-FLB1-PC"] <- "Keine"
#d_hind_s$indic[d_hind_s$indic=="BS-FLB2-PC"] <- "Insufficient Demand"



p <- ggplot(data = d_hind_s) + 
    geom_line(mapping = aes(x = time, y = values, color=indic),size=.6) + 
    scale_color_manual(values = c("#eb4255","#8E44AD","#ffa500","#659065","#A0522D")) +
    #  geom_text(data=dat %>% group_by(geo)%>% filter(time==max(time)),size=2.6) + 
    # theme(legend.position="left")+
    #  scale_color_manual(values = c("#8E44AD", "#F1C40F","#34495E","#138D75","#E74C3C","#F8C471"))+
    labs(caption="Quelle: Eurostat", #title = "Erwerbslosenrate",
      #subtitle = "Quelle: Eurostat",
      y = "",
      x = "") +
    theme_minimal()+
    theme(legend.position="bottom",legend.title=element_blank()) + 
    guides(color = guide_legend(nrow = 2, byrow = TRUE)) +
    coord_fixed(ratio=20) +  
    #ggtitle("Inflationsraten - excluding energy")+
    theme(text = element_text(size = 15))+
    scale_y_continuous(labels = function(x) paste0(x*1, "%")) +
    scale_x_date(date_breaks = "12 month", date_labels ="%m-%Y")+
    theme(axis.text.x = element_text( 
      angle = 90, 
      #color="blue", 
      vjust=0.6),strip.text.x = element_text(face = "bold")#,
      #size=15)#, 
      #  face=1)
    )+ 
    #facet_wrap(~ LOCATION, nrow = 2) 
    facet_wrap(factor(geo,levels=c("EU-19","Deutschland","Frankreich","Italien","Österreich")) ~ .,nrow=2) #+
    #geom_text_repel(
    #aes(x=Time,y = values,label=values), data = data_ends,
    #fontface ="plain", color = "black", size = 5
 # ) 

pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/wrap_Hin_s.pdf')
print(p)
dev.off()

```
\begin{figure}[] \centering
\includegraphics[trim={0 2.5cm 0 0cm },clip,width=\textwidth]
{/Users/simonwey/Repos/Foreign_economics/Graphics/wrap_Hin_s.pdf}
\caption{Dienstleistungen: Hemmnisse beim Erbringen von Dienstleistungen} 
\label{Inf_M_W}
\end{figure}

```{r}
x <- structure(c(filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="EU-19")$values[2], filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="Deutschland")$values[2], filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="Frankreich")$values[2], filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="Italien")$values[2],filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="Österreich")$values[2], filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="EU-19")$values[1]-filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="EU-19")$values[2], filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="Deutschland")$values[1], filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="Frankreich")$values[1], filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="Italien")$values[1],filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="Österreich")$values[1],filter(d_hind_s,indic=="Keine" & geo=="EU-19")$values[2], filter(d_hind_s,indic=="Keine" & geo=="Deutschland")$values[2], filter(d_hind_s,indic=="Keine" & geo=="Frankreich")$values[2], filter(d_hind_s,indic=="Keine" & geo=="Italien")$values[2],filter(d_hind_s,indic=="Keine" & geo=="Österreich")$values[2],filter(d_hind_s,indic=="Keine" & geo=="EU-19")$values[1], filter(d_hind_s,indic=="Keine" & geo=="Deutschland")$values[1], filter(d_hind_s,indic=="Keine" & geo=="Frankreich")$values[1], filter(d_hind_s,indic=="Keine" & geo=="Italien")$values[1],filter(d_hind_s,indic=="Keine" & geo=="Österreich")$values[1],filter(d_hind_s,indic=="Andere" & geo=="EU-19")$values[2], filter(d_hind_s,indic=="Andere" & geo=="Deutschland")$values[2], filter(d_hind_s,indic=="Andere" & geo=="Frankreich")$values[2], filter(d_hind_s,indic=="Andere" & geo=="Italien")$values[2],filter(d_hind_s,indic=="Andere" & geo=="Österreich")$values[2],filter(d_hind_s,indic=="Andere" & geo=="EU-19")$values[1], filter(d_hind_s,indic=="Andere" & geo=="Deutschland")$values[1], filter(d_hind_s,indic=="Andere" & geo=="Frankreich")$values[1], filter(d_hind_s,indic=="Andere" & geo=="Italien")$values[1],filter(d_hind_s,indic=="Andere" & geo=="Österreich")$values[1]),.Dim = c(5, 6), .Dimnames = structure(list(Actual = c("EU-19", "Deutschland","Frankreich","Italien","Österreich"), Predicted = c(format(filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[2],"%B"),format(filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[1],"%B"),format(filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[2],"%B"),format(filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[1],"%B"),format(filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[2],"%B"),paste("$\\Delta$", "Hallo"))), .Names = c("Actual", "Predicted")), class = "table")


#format(filter(d_hind_s,indic=="Arbeitskräftemangel" & geo=="EU-19")$time[1],"%B"))

PrintConfusionMatrix <- function(data, ...) {

  stopifnot(all(dim(x) == c(5, 6)))

#  colnames(x) <- sprintf("\\emph{%s}", colnames(x)) # highlight colnames
#  rownames(x) <- sprintf("\\emph{%s}", rownames(x)) # highlight rownames

  cat('\\begin{tabular}{|c *{8}{|C{2cm}}|} \\cline{2-7}
    \\multicolumn{1}{c|}{} & \\multicolumn{6}{c|}{\\textbf{Einschätzungen Hemmnisse}} \\\\ \\cline{2-7}
    \\multicolumn{1}{c|}{} & \\multicolumn{2}{c|}{\\textbf{Arbeitskräftemangel}} & \\multicolumn{2}{c|}{\\textbf{Keine}} & \\multicolumn{2}{c|}{\\textbf{Andere}} \\\\ \\hline
    \\textbf{Land} ')


  print(xtable(x,
               caption="Selected observations from **weatherAUS**."),
        only.contents = TRUE, 
        comment = FALSE,
        sanitize.colnames.function = identity, 
        sanitize.rownames.function = identity, 
        hline.after = 0:5,
        ...)
  cat("\\end{tabular}")
}
```

```{r, results='asis'}
PrintConfusionMatrix(x,)
```

```{r plot300, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}
rm(list=ls())


cat <- c("AT","DE","EA19","FR","IT")
t <- c("BS-EEI-I")  #  ,"BS-ESI-I",

dat_empl_exp_wh <- get_eurostat(id="ei_bsee_m_r2") #Industry (quarterly: ei_bsin_q_r2)

d_empl_exp_wh <- filter(dat_empl_exp_wh,unit== "INX",indic %in% t, geo %in% cat, s_adj =="SA",time>="2020-01-01")

d_empl_exp_wh$geo[d_empl_exp_wh$geo=="AT"] <- "Österreich"
d_empl_exp_wh$geo[d_empl_exp_wh$geo=="EA19"] <- "EU-19"
d_empl_exp_wh$geo[d_empl_exp_wh$geo=="DE"] <- "Deutschland"
d_empl_exp_wh$geo[d_empl_exp_wh$geo=="FR"] <- "Frankreich"
d_empl_exp_wh$geo[d_empl_exp_wh$geo=="IT"] <- "Italien"
d_empl_exp_wh$indic[d_empl_exp_wh$indic=="BS-EEI-I"] <- "Gesamtwirtschaft"


p <- ggplot(data = d_empl_exp_wh) +
geom_line(mapping = aes(x = time, y = values, color=indic),size=.6) +
labs(#title = "Erwerbslosenrate",
#subtitle = "Quelle: Eurostat",
y = "",
x = "") +
theme_minimal()+
theme(legend.position="bottom",legend.title=element_blank()) +
guides(color = guide_legend(nrow = 2, byrow = TRUE)) +
coord_fixed(ratio=10) +
#ggtitle("Inflationsraten - excluding energy")+
theme(text = element_text(size = 12))+
scale_y_continuous(labels = function(x) paste0(x*1, "%")) +
scale_x_date(date_breaks = "6 month", date_labels ="%m-%Y")+
theme(axis.text.x = element_text(
angle = 90,
#color="blue",
vjust=0.6),strip.text.x = element_text(face = "bold")#,
    )+ 
    #facet_wrap(~ LOCATION, nrow = 2) 
    facet_wrap(factor(geo,levels=c("EU-19","Deutschland","Frankreich","Italien","Österreich")) ~ .,nrow=2) #+
    #geom_text_repel(


pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/BSC.pdf')
print(p)
dev.off()

```
\begin{figure}[] \centering
\includegraphics[trim={0 2.5cm 0 0cm },clip,width=\textwidth]
{/Users/simonwey/Repos/Foreign_economics/Graphics/BSC.pdf}
\caption{Gesamtwirtschaft: Beschäftigungsaussichten nächste 3 Mt.} 
\label{Inf_M_W}
\end{figure}


```{r plot310, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}

rm(list=ls())

cat <- c("AT","DE","EA19","FR","IT")
t <- c("BS-EEI-I","BS-IEME-BAL","BS-CEME-BAL","BS-REM-BAL","BS-SEEM-BAL")  #  ,"BS-ESI-I",

dat_empl_exp_eco <- get_eurostat(id="ei_bsee_m_r2") #Industry (quarterly: ei_bsin_q_r2)

d_empl_exp_eco <- filter(dat_empl_exp_eco,unit== "BAL",indic %in% t, geo %in% cat, s_adj =="SA",time>="2020-01-01")

d_empl_exp_eco$geo[d_empl_exp_eco$geo=="AT"] <- "Österreich"
d_empl_exp_eco$geo[d_empl_exp_eco$geo=="EA19"] <- "EU-19"
d_empl_exp_eco$geo[d_empl_exp_eco$geo=="DE"] <- "Deutschland"
d_empl_exp_eco$geo[d_empl_exp_eco$geo=="FR"] <- "Frankreich"
d_empl_exp_eco$geo[d_empl_exp_eco$geo=="IT"] <- "Italien"
#d_empl_exp_eco$indic[d_empl_exp_eco$indic=="BS-EEI-I"] <- "Gesamtwirtschaft"
d_empl_exp_eco$indic[d_empl_exp_eco$indic=="BS-IEME-BAL"] <- "Industrie"
d_empl_exp_eco$indic[d_empl_exp_eco$indic=="BS-CEME-BAL"] <- "Baugewerbe"
d_empl_exp_eco$indic[d_empl_exp_eco$indic=="BS-REM-BAL"] <- "Einzelhandel"
d_empl_exp_eco$indic[d_empl_exp_eco$indic=="BS-SEEM-BAL"] <- "Dienstleistungen"

p <- ggplot(data =d_empl_exp_eco ) +
geom_line(mapping = aes(x = time, y = values, color=indic),size=.6) +
scale_color_manual(values = c("#eb4255","#8E44AD","#ffa500","#659065","#A0522D")) +
#  geom_text(data=dat %>% group_by(geo)%>% filter(time==max(time)),size=2.6) +
# theme(legend.position="left")+
#  scale_color_manual(values = c("#8E44AD", "#F1C40F","#34495E","#138D75","#E74C3C","#F8C471"))+
labs(#title = "Erwerbslosenrate",
#subtitle = "Quelle: Eurostat",
y = "",
x = "") +
theme_minimal()+
theme(legend.position="bottom",legend.title=element_blank()) +
guides(color = guide_legend(nrow = 2, byrow = TRUE)) +
theme(text = element_text(size = 12))+
scale_y_continuous(labels = function(x) paste0(x*1, "%")) +
scale_x_date(date_breaks = "12 month", date_labels ="%m-%Y")+
theme(axis.text.x = element_text(
angle = 90,
#color="blue",
vjust=0.6),strip.text.x = element_text(face = "bold")#,
#size=15)#,
#  face=1)
)+
#facet_wrap(~ LOCATION, nrow = 2)
facet_wrap(factor(geo,levels=c("EU-19","Deutschland","Frankreich","Italien","Österreich")) ~ .,nrow=2) #+
#geom_text_repel(
#aes(x=Time,y = values,label=values), data = data_ends,
#fontface ="plain", color = "black", size = 5
# )
pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/wrap_empl_exp_eco.pdf')
print(p)
dev.off()

```
\begin{figure}[] \centering
\includegraphics[trim={0 2.5cm 0 0cm },clip,width=\textwidth]
{/Users/simonwey/Repos/Foreign_economics/Graphics/wrap_empl_exp_eco.pdf}
\caption{Sektoren und Branchen: Beschäftigungsaussichten nächste 3 Mt.} 
\label{Inf_M_W}
\end{figure}

```{r plot30, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}

rm(list=ls())

cat <- c("AT","DE","EA19","FR","IT","SE")
t <- c("BS-CSMCI","BS-UE-NY")  #  ,"BS-ESI-I",

dat_cons_mood <- get_eurostat(id="ei_bsco_m") #Industry (quarterly: ei_bsin_q_r2)

d_cons_mood <- filter(dat_cons_mood,unit== "BAL",indic %in% t, geo %in% cat, s_adj =="SA",time>="2010-01-01")

d_cons_mood$geo[d_cons_mood$geo=="AT"] <- "Österreich"
d_cons_mood$geo[d_cons_mood$geo=="EA19"] <- "EU-19"
d_cons_mood$geo[d_cons_mood$geo=="DE"] <- "Deutschland"
d_cons_mood$geo[d_cons_mood$geo=="FR"] <- "Frankreich"
d_cons_mood$geo[d_cons_mood$geo=="IT"] <- "Italien"
d_cons_mood$indic[d_cons_mood$indic=="BS-CSMCI"] <- "Konsumentenstimmung"
d_cons_mood$indic[d_cons_mood$indic=="BS-UE-NY"] <- "Arbeitslosigkeit in den nächsten 12 Mt."


p <- ggplot(data =d_cons_mood ) +
geom_line(mapping = aes(x = time, y = values, color=indic),size=.6) +
scale_color_manual(values = c("#eb4255","#8E44AD","#ffa500","#659065","#A0522D")) +
#  geom_text(data=dat %>% group_by(geo)%>% filter(time==max(time)),size=2.6) +
# theme(legend.position="left")+
#  scale_color_manual(values = c("#8E44AD", "#F1C40F","#34495E","#138D75","#E74C3C","#F8C471"))+
labs(#title = "Erwerbslosenrate",
#subtitle = "Quelle: Eurostat",
y = "",
x = "") +
theme_minimal()+
theme(legend.position="bottom",legend.title=element_blank()) +
guides(color = guide_legend(nrow = 2, byrow = TRUE)) +
theme(text = element_text(size = 12))+
scale_y_continuous(labels = function(x) paste0(x*1, "%")) +
scale_x_date(date_breaks = "24 month", date_labels ="%m-%Y")+
theme(axis.text.x = element_text(
angle = 90,
#color="blue",
vjust=0.6),strip.text.x = element_text(face = "bold")#,
#size=15)#,
#  face=1)
)+
#facet_wrap(~ LOCATION, nrow = 2)
facet_wrap(factor(geo,levels=c("EU-19","Deutschland","Frankreich","Italien","Österreich")) ~ .,nrow=2) #+
#geom_text_repel(
#aes(x=Time,y = values,label=values), data = data_ends,
#fontface ="plain", color = "black", size = 5
# )
pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/cons_mood.pdf')
print(p)
dev.off()

```
\begin{figure}[] \centering
\includegraphics[trim={0 2.5cm 0 0cm },clip,width=\textwidth]
{/Users/simonwey/Repos/Foreign_economics/Graphics/cons_mood.pdf}
\caption{Konsumentenstimmung und Indikator zur Angst, die Stelle in den nächsten 12 Mt. zu verlieren} 
\label{Inf_M_W}
\end{figure}

```{r plot301, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}

rm(list=ls())


cat <- c("AT","DE","EA19","FR","IT")
t <- c("BS-IEME-BAL","BS-SEEM-BAL")  #  ,"BS-ESI-I",

dat_empl_exp_eco <- get_eurostat(id="ei_bsee_m_r2") #Industry (quarterly: ei_bsin_q_r2)

d_empl_exp_eco <- filter(dat_empl_exp_eco,unit== "BAL",indic %in% t, geo %in% cat, s_adj =="SA",time>="2020-01-01")

d_empl_exp_eco$geo[d_empl_exp_eco$geo=="AT"] <- "Österreich"
d_empl_exp_eco$geo[d_empl_exp_eco$geo=="EA19"] <- "EU-19"
d_empl_exp_eco$geo[d_empl_exp_eco$geo=="DE"] <- "Deutschland"
d_empl_exp_eco$geo[d_empl_exp_eco$geo=="FR"] <- "Frankreich"
d_empl_exp_eco$geo[d_empl_exp_eco$geo=="IT"] <- "Italien"
d_empl_exp_eco$indic[d_empl_exp_eco$indic=="BS-IEME-BAL"] <- "Industrie: Beschäftigungserwartung nächste 3 Mt."
d_empl_exp_eco$indic[d_empl_exp_eco$indic=="BS-SEEM-BAL"] <- "Dienstleistungen: Beschäftigungserwartung nächste 3 Mt."

p <- ggplot(data =d_empl_exp_eco ) +
geom_line(mapping = aes(x = time, y = values, color=indic),size=.6) +
scale_color_manual(values = c("#eb4255","#8E44AD","#ffa500","#659065","#A0522D")) +
#  geom_text(data=dat %>% group_by(geo)%>% filter(time==max(time)),size=2.6) +
# theme(legend.position="left")+
#  scale_color_manual(values = c("#8E44AD", "#F1C40F","#34495E","#138D75","#E74C3C","#F8C471"))+
labs(#title = "Erwerbslosenrate",
#subtitle = "Quelle: Eurostat",
y = "",
x = "") +
theme_minimal()+
theme(legend.position="bottom",legend.title=element_blank()) +
guides(color = guide_legend(nrow = 2, byrow = TRUE)) +
coord_fixed(ratio=10) +
#ggtitle("Inflationsraten - excluding energy")+
theme(text = element_text(size = 12))+
scale_y_continuous(labels = function(x) paste0(x*1, "%")) +
scale_x_date(date_breaks = "12 month", date_labels ="%m-%Y")+
theme(axis.text.x = element_text(
angle = 90,
#color="blue",
vjust=0.6),strip.text.x = element_text(face = "bold")#,
#size=15)#,
#  face=1)
)+
#facet_wrap(~ LOCATION, nrow = 2)
facet_wrap(factor(geo,levels=c("EU-19","Deutschland","Frankreich","Italien","Österreich")) ~ .,nrow=2) #+
#geom_text_repel(
#aes(x=Time,y = values,label=values), data = data_ends,
#fontface ="plain", color = "black", size = 5
# )
pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/empl_exp_sector.pdf')
print(p)
dev.off()

```

\begin{figure}[] \centering
\includegraphics[trim={0 2.5cm 0 0cm },clip,width=\textwidth]
{/Users/simonwey/Repos/Foreign_economics/Graphics/empl_exp_sector.pdf}
\caption{Beschäftigungserwartungen in der Industrie und dem Dienstleistungssektor} 
\label{Inf_M_W}
\end{figure}


```{r plot6, echo=FALSE,  include=FALSE, message=FALSE,warning=FALSE}

rm(list=ls())


tsl <- get_time_series("ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11")
s_tsl <- lapply(tsl,window, start=c(2020,1))
pdf('/Users/simonwey/Repos/Foreign_economics/Graphics/GL.pdf')
tsplot(s_tsl)
s_tsl$ch.kof.barometer[length(s_tsl$ch.kof.barometer)]
s_tsl$ch.kof.barometer[length(s_tsl$ch.kof.barometer)-1]
s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11

dates_2 <- date_decimal(as.numeric(time(s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11)))
dev.off()


```
\begin{figure}[] \centering
\includegraphics[trim={0 2.5cm 0 0cm },clip,width=.8\textwidth]
{/Users/simonwey/Repos/Foreign_economics/Graphics/GL.pdf}
\caption{Geschäftslagenindikator mit aktuellem Wert `r round(s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11
[length(s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11
)],1)
`} 
\label{Inf_M_W}
\end{figure}

**Monat** | **`r month(dates_2[length(date_decimal(as.numeric(time(s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11))))-1],label=TRUE,abbr = FALSE)`** | **`r month(dates_2[length(date_decimal(as.numeric(time(s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11))))],label=TRUE,abbr = FALSE)`**
------------- | -------------|-------------
**KOF-Geschäftslageindikator** | `r round(s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11[length(s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11)-1],1)` | `r round(s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11[length(s_tsl$ch.kof.bts_total.ng08.fx.q_ql_ass_bs.balance.d11)],1)`
Table: Geschäftslageindikator, letzte Werte. Quelle: KOF

# Ausgangslage



